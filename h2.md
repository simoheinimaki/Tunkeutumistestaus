# h2

## Tiivistelmät

- Kaikki hyödylliset komennot saa selville komennolla "help" tai "?"
- Kannattaa hyödyntää tietokantoja tulosten tallentamiseen tunkeutumistestauksissa.
- Käytä eri Workspace:ja välttyäksesi Tietojen sekottumiselta.

## a)
Kali Linux ja Metasploitable virtuaalikoneet eivät ole yhteydessä internetiin, mutta saavat yhteyden toisiinsa:

<img width="525" height="266" alt="kuva" src="https://github.com/user-attachments/assets/655c8ecf-5ee4-458c-934d-f051613da1dd" />


<img width="447" height="58" alt="kuva" src="https://github.com/user-attachments/assets/0805456f-f4a9-4767-8c34-1fcb00a2ae12" />

## b)
Msf consolen saa käyttöön Kali koneella komennolla:
<img width="635" height="645" alt="kuva" src="https://github.com/user-attachments/assets/0c5e8b8e-112b-437d-a9fe-96a529c6c694" />


    msfconsole
    
## c)
Ennen skannaamista loin uuden tietokannan komennolla:

    sudo msfdb init

Minulla ilmeni ongelmia tietokantaan yhdistämisessä, joten käynnistin msfconsolen uudestaan, ja sain lopulta automaattisesti yhdistettyä tietokantaan.

<img width="695" height="227" alt="kuva" src="https://github.com/user-attachments/assets/f9c93a7c-be46-41bd-9227-6a8f809f8606" />


Sitten Etsin metasploitablen porttiskannaamalla.

    db_nmap -sn

<img width="1291" height="113" alt="kuva" src="https://github.com/user-attachments/assets/c8dab947-9915-48bf-9a43-0c853c4fd3f7" />

## d)
Seuraavaksi porttiskannaan Metasploitablen huolellisesti komennolla:

    db_nmap -A -p-

sekä komennola

    nmap -oA foo

<img width="900" height="787" alt="kuva" src="https://github.com/user-attachments/assets/4de8f08f-2e87-4ed1-8771-5b6cbb558ab2" />

<img width="1216" height="452" alt="kuva" src="https://github.com/user-attachments/assets/61be6cac-1810-4d3f-b900-fae3eb1c0b39" />

## e)
Skannattuani Metasploitablen huolellisesti, voin tarkastella tietokantaan tallennettua dataa koneesta komennoilla "hosts" ja "services

<img width="761" height="133" alt="kuva" src="https://github.com/user-attachments/assets/18f1c8ca-fca4-424f-be91-8493740047df" />

<img width="562" height="491" alt="kuva" src="https://github.com/user-attachments/assets/6c0556c6-1b6e-45ff-84db-99232e753dea" />


## f)

    nmap -oA foo
Tiedostoihin tallentaessa on data tallennettu helposti luettavaan muotoon. tietoa on helppo löytää esimerkiksi Greppaamalla.

    db_nmap -
Tietokantaa on helppo käyttää komennoilla ja filtteröimällä tietoa. 
## g)
Aloitan Etsimällä vsftpd exploitin komennolla

        search vsftpd
        
<img width="1023" height="167" alt="kuva" src="https://github.com/user-attachments/assets/77b7d121-af90-480e-9175-2a86f0c98469" />

Löytyi kaksi haavoittuvuutta, joten koitan ensimmäisenä 0, jos sillä pääsisi sisään.

valitsen hyökkäyksen kohteen komennolla 

    setg RHOSTS
+ IP-osoite

jonka jälkeen koitin exploittia

<img width="807" height="80" alt="kuva" src="https://github.com/user-attachments/assets/29d0284a-bbcb-4582-b30a-eef8bf1b3e98" />

0 haavoittuvuus epäonnistui, joten koitetaan 1

<img width="942" height="591" alt="kuva" src="https://github.com/user-attachments/assets/3b9f71e0-2107-437e-be4c-41f86421b95c" />

pääsin tällä sisään.
## h)

voin tallentaa session meterpreteriin komennolla

        sessions -u

<img width="627" height="133" alt="kuva" src="https://github.com/user-attachments/assets/57b216f1-65b8-425f-b573-df10514b692b" />

## i)

poistuttuani kohdekoneelta, en päässyt enään saman exploitin kautta koneelle takaisin.

<img width="750" height="62" alt="kuva" src="https://github.com/user-attachments/assets/57f10583-01a4-44c9-b887-99e9a01b6dd7" />

Minulla ei ole hajuakaan mikä tämän aiheutti.

Yritin myös avata aiempaa sessiota, mutta ilmeisesti tallenus ei ollut onnistunut, joten joudun alottamaan tunkeutumisen alusta.

Käynnistin metapsloitablen uudestaan, jonka jälkeen pääsin taas vsftpd kautta shelliin.

Päästyäni takaisin tulostin Password hashit komennolla

    cat /etc/shadow

Heikosti salatut hashit voi decryptata ulkoisilla ohjelmilla.



## j)

kokeilin tunkeutumiseen telnetiä.

<img width="665" height="588" alt="kuva" src="https://github.com/user-attachments/assets/7646f33e-8c2d-4df1-8fe2-0ee8844eea55" />

Portti oli auki, sain yhteyden koneeseen ja tiesin käyttäjänimen ja salasanan. Tunkeutuminen oli helppoa siis.


## k)

<img width="421" height="142" alt="kuva" src="https://github.com/user-attachments/assets/b620339d-3a2c-4869-848d-9f8a68e1b865" />

<img width="560" height="341" alt="kuva" src="https://github.com/user-attachments/assets/45c2a261-fd30-41e8-a72f-c67e9a73b5b7" />


## l)

<img width="480" height="60" alt="kuva" src="https://github.com/user-attachments/assets/bc83e241-5a98-422f-a3e1-f5abcedd7a41" />


## Lähteet

Tehtävänanto: https://terokarvinen.com/tunkeutumistestaus/#aikataulu

Jaswal 2020. Mastering Metasploit. Kappale 1: Approaching a Penetration Test Using Metasploit. 
luettavissa: https://learning.oreilly.com/library/view/mastering-metasploit/9781838980078/B15076_01_Final_ASB_ePub.xhtml#_idParaDest-30

https://forum.hackthebox.com/t/save-sessions-in-msfconsole/281523/2 Apua meterpreterin käyttöön.

https://medium.com/@mrarslan5156/a-practice-guide-to-exploring-ftp-vulnerabilities-in-metasploitable-2-using-debian-linux-d96f7e7e82fa Apua haavoittuvuuksien löytämiseen.
